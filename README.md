# 图书管理系统 (BMS - Book Management System)

一个基于 Qt 框架开发的现代化图书管理系统，采用 C++17 标准，支持图书管理、借阅管理和用户管理等功能。项目采用模块化设计，实现了完整的权限控制和数据持久化。

## 🚀 项目特性

### 📚 核心功能模块

- **图书管理模块** (`BookManager`)：图书的增删改查、批量导入导出、多维度搜索和排序
- **借阅管理模块** (`BorrowManager`)：借书、还书、续借、逾期管理、借阅记录查询
- **用户管理模块** (`UserManager`)：用户注册、登录、权限管理、角色分配
- **权限控制模块** (`PermissionManager`)：基于角色的访问控制(RBAC)

### 🔐 权限系统

- **普通用户权限**：浏览图书、管理个人借阅记录
- **管理员权限**：图书管理、借阅管理、用户管理、系统维护
- **全局登录系统**：统一的身份认证，支持会话管理

### 💾 数据持久化

- **JSON 格式存储**：用户数据、图书信息、借阅记录
- **自动保存机制**：程序启动时加载，关闭时保存
- **数据完整性**：异常处理和错误恢复

### 🎨 用户界面

- **现代化 UI**：基于 Qt Widgets 的响应式界面
- **多页面导航**：图书管理、借阅管理、用户管理页面
- **表格排序**：支持多列排序和搜索过滤
- **分页显示**：大数据量下的高效展示

## 🏗️ 技术架构

### 核心技术栈

- **开发语言**：C++17
- **GUI 框架**：Qt 5.12+ / Qt 6.0+
- **构建系统**：CMake 3.16+
- **数据格式**：JSON
- **算法实现**：快速排序、二分查找、哈希表

### 自定义数据结构

- **MyVector**：动态数组实现，支持哈希表索引
- **MyAlgorithm**：排序算法库，支持自定义比较器
- **模块化设计**：清晰的类层次结构和职责分离

## 📁 项目结构

```
BMS-cursor/
├── include/                    # 头文件目录
│   ├── Book.h                 # 图书类定义
│   ├── BookManager.h          # 图书管理器
│   ├── User.h                 # 用户类和用户管理器
│   ├── BorrowRecord.h         # 借阅记录类
│   ├── BorrowManager.h        # 借阅管理器
│   ├── PermissionManager.h    # 权限管理器
│   ├── MyVector.h             # 自定义动态数组
│   └── Mysort.h               # 排序算法库
├── src/                       # 源文件目录
│   ├── Book.cpp               # 图书类实现
│   ├── BookManager.cpp        # 图书管理器实现
│   ├── User.cpp               # 用户管理实现
│   ├── BorrowRecord.cpp       # 借阅记录实现
│   ├── BorrowManager.cpp      # 借阅管理实现
│   └── PermissionManager.cpp  # 权限管理实现
├── Reference/                 # 参考文件和测试数据
│   ├── books.txt              # 图书数据文件
│   ├── books2.txt             # 测试数据
│   ├── books_output.txt       # 输出示例
│   ├── head/                  # 参考头文件
│   └── src/                   # 参考源文件
├── widget.h                   # 主窗口头文件
├── widget.cpp                 # 主窗口实现
├── widget.ui                  # Qt Designer UI文件
├── main.cpp                   # 程序入口
├── CMakeLists.txt             # CMake构建配置
└── README.md                  # 项目文档
```

## 🔧 编译和运行

### 环境要求

- **操作系统**：Windows 10+, macOS 10.14+, Linux
- **编译器**：支持 C++17 的编译器 (GCC 7+, Clang 5+, MSVC 2017+)
- **Qt 版本**：Qt 5.12+ 或 Qt 6.0+
- **CMake**：3.16 或更高版本

### 编译步骤

1. **克隆项目**

   ```bash
   git clone <repository-url>
   cd BMS-cursor
   ```

2. **创建构建目录**

   ```bash
   mkdir build
   cd build
   ```

3. **配置项目**

   ```bash
   cmake ..
   ```

4. **编译项目**

   ```bash
   # Linux/macOS
   make

   # Windows (使用 Visual Studio)
   cmake --build . --config Release
   ```

5. **运行程序**

   ```bash
   # Linux/macOS
   ./BMS

   # Windows
   BMS.exe
   ```

## 📖 使用指南

### 首次使用

1. **启动程序**：运行编译后的可执行文件
2. **注册账户**：首次使用需要注册用户账户
3. **登录系统**：使用注册的账户登录
4. **权限设置**：第一个注册的用户自动成为管理员

### 功能操作

#### 图书管理

- **浏览图书**：查看所有图书信息，支持排序和搜索
- **添加图书**：管理员可添加新图书（ISBN、书名、作者、出版社、出版年份）
- **编辑图书**：管理员可修改图书信息
- **删除图书**：管理员可删除图书记录
- **批量导入**：支持从文本文件批量导入图书信息

#### 借阅管理

- **借阅图书**：用户可借阅可用图书
- **归还图书**：用户可归还已借阅的图书
- **续借图书**：在到期前可续借图书
- **查看记录**：查看个人或所有借阅记录
- **逾期管理**：系统自动识别逾期图书

#### 用户管理

- **用户注册**：新用户注册功能
- **用户管理**：管理员可管理所有用户账户
- **角色分配**：设置用户权限级别
- **账户维护**：修改用户信息和密码

## 📊 数据格式

### 图书数据 (books.json)

```json
{
  "books": [
    {
      "isbn": "9787111213826",
      "title": "C++程序设计",
      "author": "谭浩强",
      "publisher": "清华大学出版社",
      "publishYear": 2010,
      "status": 0
    }
  ],
  "count": 1
}
```

### 借阅记录 (borrow_records.json)

```json
{
  "records": [
    {
      "id": 1,
      "bookIsbn": "9787111213826",
      "username": "admin",
      "borrowDate": 1703123456,
      "dueDate": 1705715456,
      "returnDate": 0,
      "isReturned": false
    }
  ],
  "count": 1
}
```

### 用户数据 (users.json)

```json
{
  "users": [
    {
      "username": "admin",
      "password": "hashed_password",
      "role": 1
    }
  ]
}
```

## 🔍 核心算法

### 搜索算法

- **哈希表查找**：O(1) 时间复杂度的快速查找
- **二分查找**：有序数据的高效搜索
- **模糊搜索**：支持部分匹配的文本搜索

### 排序算法

- **快速排序**：高效的通用排序算法
- **多字段排序**：支持按不同字段排序
- **自定义比较器**：灵活的排序规则

### 数据结构

- **动态数组**：自动扩容的向量实现
- **哈希索引**：基于 DJB2 哈希算法的索引表
- **内存管理**：智能的内存分配和释放

## 🛠️ 开发特性

### 代码质量

- **模块化设计**：清晰的类层次和职责分离
- **异常处理**：完善的错误处理和用户提示
- **内存安全**：智能指针和 RAII 资源管理
- **代码注释**：详细的中文注释和文档

### 性能优化

- **哈希表索引**：快速的数据查找
- **分页显示**：大数据量的高效处理
- **内存优化**：减少不必要的内存分配

## 📝 更新日志

### v1.0.0 (当前版本)

- ✅ 完整的图书管理系统功能
- ✅ 用户认证和权限控制
- ✅ 数据持久化和自动保存
- ✅ 现代化用户界面
- ✅ 多维度搜索和排序
- ✅ 借阅管理和逾期处理

## 👥 作者

- **陈子涵** - 项目主要开发者
- **白斌** - 协助开发

## 🙏 致谢

- Qt 框架提供的强大 GUI 支持
- CMake 构建系统的灵活性

---

**注意**：首次使用请注册管理员账户。
