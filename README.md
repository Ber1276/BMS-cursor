# 图书管理系统 (BMS)

一个基于 Qt 的图书管理系统，支持图书管理、借阅管理和用户管理功能。

## 功能特性

### 🔐 用户认证系统

- **全局登录注册**：统一的登录注册界面，支持所有需要权限的功能
- **权限管理**：普通用户和管理员两种角色，不同权限级别
- **数据持久化**：用户信息自动保存到本地文件
- **会话管理**：登录状态显示，支持登出功能

### 📚 图书管理

- 浏览图书信息（所有用户）
- 添加、编辑、删除图书（仅管理员）
- 批量导入图书信息（仅管理员）
- 图书信息包括：ISBN、书名、作者、出版社、出版年份

### 📖 借阅管理

- 借书、还书、续借功能
- 借阅记录管理
- 逾期提醒
- 普通用户只能管理自己的记录，管理员可以管理所有记录

### 👥 用户管理

- 添加、编辑、删除用户
- 角色管理（普通用户/管理员）
- 仅管理员可访问

## 权限说明

### 普通用户权限

- 浏览图书信息
- 查看自己的借阅记录
- 借阅图书（为自己）
- 归还自己的图书
- 续借自己的图书

### 管理员权限

- 浏览图书信息
- 图书管理（增删改、批量导入）
- 借阅管理（查看所有记录，为任何用户借书、还书、续借）
- 用户管理（增删改）

## 使用说明

### 首次使用

1. 启动程序后默认显示图书管理页面
2. 点击"借阅管理"或"用户管理"会弹出登录对话框
3. 选择"注册"创建新账户
4. 注册成功后返回登录界面进行登录

### 日常使用

- **图书管理**：无需登录，可直接浏览图书信息（增删改操作需要管理员权限）
- **借阅管理**：需要登录，普通用户只能管理自己的借阅记录，管理员可以管理所有记录
- **用户管理**：需要管理员权限，可管理所有用户账户

### 登录状态

- 标题栏显示当前登录状态和用户信息
- 登录后可看到"登出"按钮
- 登出后自动切换到图书管理页面

## 技术特性

- **现代化 UI**：基于 Qt 的现代化界面设计
- **数据持久化**：用户数据自动保存到本地 JSON 文件
- **异常处理**：完善的错误处理和用户提示
- **权限控制**：基于角色的访问控制
- **响应式设计**：支持窗口大小调整

## 文件结构

```
BMS-cursor/
├── include/           # 头文件
│   ├── Book.h        # 图书类
│   ├── BookManager.h # 图书管理器
│   ├── User.h        # 用户类
│   ├── BorrowRecord.h # 借阅记录
│   ├── BorrowManager.h # 借阅管理器
│   └── PermissionManager.h # 权限管理器
├── src/              # 源文件
├── widget.h          # 主窗口头文件
├── widget.cpp        # 主窗口实现
├── widget.ui         # UI文件
└── main.cpp          # 程序入口
```

## 编译运行

### 环境要求

- Qt 5.12+ 或 Qt 6.0+
- CMake 3.16+
- C++17 编译器

### 编译步骤

```bash
mkdir build
cd build
cmake ..
make
```

### 运行

```bash
./BMS
```

## 数据文件

程序会在运行目录下创建以下数据文件：

- `users.json` - 用户数据文件

## 注意事项

1. 首次使用需要注册用户账户
2. 管理员账户拥有最高权限，请妥善保管
3. 用户数据保存在本地，请定期备份
4. 程序支持无边框窗口，可通过标题栏按钮控制窗口

## 更新日志

### v1.0.0

- 重写用户认证系统
- 实现全局登录注册功能
- 添加权限控制和页面导航
- 完善数据持久化
- 优化用户界面和交互体验
